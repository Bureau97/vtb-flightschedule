{"version":3,"file":"vtb-flightschedule.js","sourceRoot":"","sources":["../src/vtb-flightschedule.ts"],"names":[],"mappings":"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","sourcesContent":["import {LitElement, css, html} from 'lit';\nimport {customElement, property} from 'lit/decorators.js';\nimport {ifDefined} from 'lit/directives/if-defined.js';\nimport {TemplateResult} from 'lit-element';\n\nimport dayjs, {type Dayjs} from 'dayjs';\nimport 'dayjs/locale/nl'; // import locale\ndayjs.locale('nl');\n\n@customElement('vtb-flight')\nclass VtbFlight extends LitElement {\n  @property({type: String})\n  IATA?: string;\n\n  @property({type: String})\n  date?: string;\n\n  @property({type: String})\n  time?: string;\n\n  @property({type: String})\n  timezone = '02:00';\n\n  @property({type: String})\n  dateformat = 'DD MMM (hh:mm)';\n\n  type = 'departure';\n\n  static override styles = css`\n    :host {\n      width: 100%;\n    }\n\n    .row > div {\n      display: inline-block;\n    }\n\n    .date,\n    .time,\n    .description,\n    .carrier {\n      padding: 0 1rem;\n    }\n  `;\n\n  override render() {\n    const datestring = `${this.date}T${this.time}:00`;\n    const date = dayjs(datestring);\n\n    if (!this.dateformat || this.dateformat == '') {\n      return html`\n        <div class=\"row ${this.type}\">\n          <div class=\"date-time\"></div>\n          <div class=\"description\"><slot></slot></div>\n        </div>\n      `;\n    } else {\n      return html`\n        <div class=\"row ${this.type}\">\n          <div class=\"date-time\">${date.format(this.dateformat)}</div>\n          <div class=\"description\"><slot></slot></div>\n        </div>\n      `;\n    }\n  }\n}\n\n@customElement('vtb-flight-departure')\nexport class VtbFlightDeparture extends VtbFlight {\n  override type = 'departure';\n}\n\n@customElement('vtb-flight-arrival')\nexport class VtbFlightArrival extends VtbFlight {\n  override type = 'arrival';\n}\n\n@customElement('vtb-flight-element')\nexport class VtbFlightElement extends LitElement {\n  @property({type: String})\n  flightnumber?: string;\n\n  @property({type: String})\n  carrier?: string;\n\n  static override styles = css`\n    :host {\n      width: 100%;\n    }\n\n    .flight {\n      display: grid;\n      grid-template-columns: 2fr 2fr 1fr;\n      column-gap: 0.5rem;\n      row-gap: 0.5rem;\n    }\n  `;\n\n  override render() {\n    return html`\n      <div class=\"flight\">\n        <slot></slot>\n        <div class=\"carrier\">${this.carrier}</div>\n      </div>\n    `;\n  }\n}\n\n@customElement('vtb-flightschedule')\nexport class VtbFlightSchedule extends LitElement {\n  @property({\n    type: Array,\n  })\n  flightinfo?: Array<VtbFlightData>;\n\n  @property({type: String})\n  dateformat = 'DD MMM (hh:mm)';\n\n  override render() {\n    let _innerHTML: string | TemplateResult = '';\n    if (this.children.length == 0 && this.flightinfo) {\n      _innerHTML = this._renderFlightInfo();\n    }\n    return html`\n      <div class=\"flight-schedule\">\n        <slot>${_innerHTML}</slot>\n      </div>\n    `;\n  }\n\n  private _renderFlightInfo() {\n    const flightinfo = this.flightinfo as Array<VtbFlightElementData>;\n\n    const scheduleTemplates = [];\n    for (const _schedule of flightinfo) {\n      let departure_date: string | Dayjs | Date | null = null;\n      let departure_time: string | Dayjs | Date | null = null;\n      let arrival_date: string | Dayjs | Date | null = null;\n      let arrival_time: string | Dayjs | Date | null = null;\n\n      if (\n        _schedule.departure?.date &&\n        typeof _schedule.departure?.date == 'string'\n      ) {\n        departure_date = dayjs(_schedule.departure?.date);\n      }\n\n      if (\n        _schedule.departure?.time &&\n        typeof _schedule.departure?.time == 'string'\n      ) {\n        const _time = _schedule.departure.time as string;\n        const _s = _time.split(/:/);\n\n        departure_time = dayjs()\n          .set('hour', parseInt(_s[0], 10))\n          .set('minute', parseInt(_s[1], 10))\n          .set('second', 0);\n      }\n\n      if (\n        _schedule.arrival?.date &&\n        typeof _schedule.arrival?.date == 'string'\n      ) {\n        arrival_date = dayjs(_schedule.arrival?.date);\n      }\n\n      if (\n        _schedule.arrival?.time &&\n        typeof _schedule.arrival?.time == 'string'\n      ) {\n        const _time = _schedule.arrival.time as string;\n        const _s = _time.split(/:/);\n\n        arrival_time = dayjs()\n          .set('hour', parseInt(_s[0], 10))\n          .set('minute', parseInt(_s[1], 10))\n          .set('second', 0);\n      }\n\n      scheduleTemplates.push(html`\n        <vtb-flight-element carrier=${ifDefined(_schedule.carrier?.name)}>\n          <vtb-flight-departure\n            date=${ifDefined(departure_date?.format('YYYY-MM-DD'))}\n            time=${ifDefined(departure_time?.format('HH:mm'))}\n            IATA=${ifDefined(_schedule.departure?.IATA)}\n            dateformat=${this.dateformat}\n          >\n            ${ifDefined(_schedule.departure?.description)}\n          </vtb-flight-departure>\n          <vtb-flight-arrival\n            date=${ifDefined(arrival_date?.format('YYYY-MM-DD'))}\n            time=${ifDefined(arrival_time?.format('HH:mm'))}\n            IATA=${ifDefined(_schedule.arrival?.IATA)}\n            dateformat=${this.dateformat}\n          >\n            ${ifDefined(_schedule.arrival?.description)}\n          </vtb-flight-arrival>\n        </vtb-flight-element>\n      `);\n    }\n    return html`${scheduleTemplates}`;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'vtb-flightschedule': VtbFlightSchedule;\n    'vtb-flight-element': VtbFlightElement;\n    'vtb-flight-departure': VtbFlightDeparture;\n    'vtb-flight-arrival': VtbFlightArrival;\n  }\n}\n\nexport class VtbFlightData {\n  date?: Date;\n  time?: Date;\n  IATA?: string;\n  dateformat?: string = 'DD MMM';\n  timezone?: string = 'UTC+01:00';\n  country?: string;\n  city?: string;\n  description?: string;\n}\n\nexport class VtbFlightCarrier {\n  name?: string;\n  code?: string;\n}\n\nexport class VtbFlightElementData {\n  departure?: VtbFlightData;\n  arrival?: VtbFlightData;\n  carrier?: VtbFlightCarrier;\n  flightnumber?: string;\n  day?: number;\n}\n\nexport class VtbFlightDataTransformer {\n  load(vtbSrcData: any) {  // eslint-disable-line @typescript-eslint/no-explicit-any\n    const flightElements: Array<VtbFlightElementData> = [];\n    for (const segment of vtbSrcData.segments) {\n      if (!segment.flightinfo || segment.flightinfo.length <= 0) {\n        continue;\n      }\n\n      for (const flight of segment.flightinfo) {\n        const carrier = new VtbFlightCarrier();\n        carrier.name = flight.airlineObject.carrier_name;\n        carrier.code = flight.airlineObject.carrier_code;\n\n        const departure = new VtbFlightData();\n        departure.date = new Date(flight.departureDate);\n        // departure.time = new Date().setTime(flight.departureTime);\n        departure.IATA = flight.departureAirport;\n        departure.description = flight.departureAirportObject.description;\n        departure.country = flight.departureAirportObject.country;\n        departure.city = flight.departureAirportObject.city;\n\n        const arrival = new VtbFlightData();\n        arrival.date = new Date(flight.arrivalDate);\n        // arrival.time = new Date().setTime(flight.arrivalTime);\n        arrival.IATA = flight.arrivalAirport;\n        arrival.description = flight.arrivalAirportObject.description;\n        arrival.country = flight.arrivalAirportObject.country;\n        arrival.city = flight.arrivalAirportObject.city;\n\n        const flightElement = new VtbFlightElementData();\n        flightElement.carrier = carrier;\n        flightElement.departure = departure;\n        flightElement.arrival = arrival;\n        flightElement.flightnumber = flight.flightNumber;\n        flightElement.day = segment.day;\n\n        flightElements.push(flightElement);\n      }\n    }\n\n    return flightElements;\n  }\n}\n"]}